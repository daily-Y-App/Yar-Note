<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ“Š Advanced Income & Expense Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://pl28343252.effectivegatecpm.com/b0/32/35/b0323521ab92aa35ff4ce77822b78adc.js"></script>
    <script src="https://pl28344759.effectivegatecpm.com/eb/25/40/eb25401554277dcd898bb0414f0023b0.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; min-height: 100vh; padding-bottom: 80px; }
        .app-header { background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d); color: white; padding: 20px; display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .profile-photo { width: 55px; height: 55px; border-radius: 50%; background: rgba(255,255,255,0.2); border: 2px solid white; display: flex; align-items: center; justify-content: center; font-size: 28px; }
        .tabs { display: flex; background: white; position: sticky; top: 0; z-index: 1000; overflow-x: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .tab { flex: 1; min-width: 80px; padding: 12px 5px; text-align: center; cursor: pointer; background: white; border: none; font-size: 11px; font-weight: bold; color: #777; transition: 0.3s; border-bottom: 3px solid transparent; }
        .tab.active { color: #b21f1f; border-bottom-color: #b21f1f; background: #fff5f5; }
        .tab-icon { display: block; font-size: 20px; margin-bottom: 3px; }
        .content { padding: 15px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 15px; border: 1px solid #eee; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; color: #444; font-size: 13px; }
        input, select { width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 15px; outline: none; }
        .btn { width: 100%; padding: 14px; background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; box-shadow: 0 4px 15px rgba(178, 31, 31, 0.3); }
        .balance-hero { background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white; padding: 30px 20px; border-radius: 20px; text-align: center; margin-bottom: 20px; }
        .stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-box { padding: 15px; border-radius: 12px; text-align: center; font-weight: bold; }
        .stat-inc { background: #e8f5e9; color: #2e7d32; }
        .stat-exp { background: #ffebee; color: #c62828; }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; justify-content:center; align-items:center; }
        .modal-content { background:white; width:90%; border-radius:20px; padding:25px; text-align:center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .done-btn { background: #4CAF50; color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; margin-top: 15px; width: 100%; cursor: pointer; }
        .ad-slot-box { margin: 15px 0; min-height: 120px; background: #f9f9f9; border-radius: 10px; border: 1px dashed #ccc; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .btn-link { display: block; width: 100%; padding: 14px; text-align: center; text-decoration: none; border-radius: 12px; font-weight: bold; font-size: 16px; margin-top: 10px; border: none; cursor: pointer; }
        .btn-yapp { background: #fdbb2d; color: #1a2a6c; }
    </style>
</head>
<body onclick="initBackLogic()">

    <div class="app-header">
        <div class="profile-photo">ğŸ‘¤</div>
        <div>
            <div id="headName" style="font-weight: bold; font-size: 18px;">User Name</div>
            <div id="headCode" style="font-size: 12px; opacity: 0.9;">CODE: EMP001</div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="showPage('income', this)"><span class="tab-icon">ğŸ’°</span><span>á€á€„á€ºá€„á€½á€±</span></div>
        <div class="tab" onclick="showPage('expense', this)"><span class="tab-icon">ğŸ’¸</span><span>á€‘á€½á€€á€ºá€„á€½á€±</span></div>
        <div class="tab" onclick="showPage('history', this)"><span class="tab-icon">ğŸ“œ</span><span>á€™á€¾á€á€ºá€á€™á€ºá€¸</span></div>
        <div class="tab" onclick="showPage('weekly', this)"><span class="tab-icon">ğŸ“…</span><span>15á€›á€€á€º</span></div>
        <div class="tab" onclick="showPage('balance', this)"><span class="tab-icon">ğŸ§®</span><span>á€œá€€á€ºá€€á€»á€”á€º</span></div>
        <div class="tab" onclick="showPage('graph', this)"><span class="tab-icon">ğŸ“Š</span><span>á€‚á€›á€•á€º</span></div>
        <div class="tab" onclick="showPage('profile', this)"><span class="tab-icon">ğŸ‘¤</span><span>Profile</span></div>
    </div>

    <div class="content">
        <div id="income" class="page active">
            <div class="card">
                <div class="form-group"><label>ğŸ“… á€›á€€á€ºá€…á€½á€²</label><input type="date" id="iDate"></div>
                <div class="form-group"><label>â° á€¡á€œá€¯á€•á€ºá€á€»á€­á€”á€º (á€”á€¬á€›á€®)</label><input type="number" id="iHours" value="8"></div>
                <div class="form-group"><label>â±ï¸ OT (á€”á€¬á€›á€®)</label><input type="number" id="iOt" value="0"></div>
                <div class="form-group"><label>ğŸ“… á€›á€€á€ºá€™á€¾á€”á€ºá€€á€¼á€±á€¸</label><input type="number" id="iBonus" value="0"></div>
                <div class="form-group"><label>ğŸ’µ á€¡á€•á€­á€¯á€á€„á€ºá€„á€½á€±</label><input type="number" id="iExtra" value="0"></div>
                <button class="btn" onclick="saveData('income')">ğŸ’¾ á€á€­á€™á€ºá€¸á€™á€Šá€º</button>
            </div>
        </div>

        <div id="expense" class="page">
            <div class="card">
                <div class="form-group"><label>ğŸ“… á€›á€€á€ºá€…á€½á€²</label><input type="date" id="eDate"></div>
                <div class="form-group">
                    <label>ğŸ“‚ á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸</label>
                    <select id="eCat" onchange="checkCustom(this.value)">
                        <option value="á€¡á€­á€™á€ºá€œá€">ğŸ  á€¡á€­á€™á€ºá€œá€</option>
                        <option value="á€á€›á€®á€¸á€…á€›á€­á€á€º">ğŸš— á€á€›á€®á€¸á€…á€›á€­á€á€º</option>
                        <option value="á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸">ğŸœ á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸</option>
                        <option value="á€¡á€‘á€½á€±á€‘á€½á€±">ğŸ“¦ á€¡á€‘á€½á€±á€‘á€½á€±</option>
                        <option value="custom">â• á€¡á€á€¼á€¬á€¸</option>
                    </select>
                    <input type="text" id="customCat" placeholder="..." style="display:none; margin-top:10px;">
                </div>
                <div class="form-group"><label>ğŸ’µ á€•á€™á€¬á€</label><input type="number" id="eAmount"></div>
                <button class="btn" onclick="saveData('expense')">ğŸ’¾ á€á€­á€™á€ºá€¸á€™á€Šá€º</button>
            </div>
        </div>

        <div id="history" class="page"><div id="historyList"></div></div>
        <div id="weekly" class="page">
            <button class="btn" style="background: #333; margin-bottom:15px;" onclick="clearAll()">ğŸ—‘ï¸ á€…á€¬á€›á€„á€ºá€¸á€¡á€¬á€¸á€œá€¯á€¶á€¸á€–á€»á€€á€ºá€™á€Šá€º</button>
            <div id="weeklyList"></div>
        </div>

        <div id="balance" class="page">
            <div class="balance-hero">
                <div>á€œá€€á€ºá€€á€»á€”á€ºá€„á€½á€± á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸</div>
                <h1 id="totalBal" style="font-size: 48px; margin: 5px 0;">0à¸¿</h1>
                <div id="workDayShow" style="font-size: 14px; background: rgba(0,0,0,0.2); display: inline-block; padding: 5px 15px; border-radius: 20px;">á€¡á€œá€¯á€•á€ºá€†á€„á€ºá€¸á€›á€€á€º: 0 á€›á€€á€º</div>
            </div>
            <div class="stats-row">
                <div class="stat-box stat-inc">á€á€„á€ºá€„á€½á€±<div id="totalInc">0à¸¿</div></div>
                <div class="stat-box stat-exp">á€‘á€½á€€á€ºá€„á€½á€±<div id="totalExp">0à¸¿</div></div>
            </div>
        </div>

        <div id="graph" class="page">
            <div class="card" style="min-height: 350px;">
                <canvas id="myChart"></canvas>
            </div>
        </div>

        <div id="profile" class="page">
            <div class="card">
                <div class="form-group"><label>á€¡á€™á€Šá€º</label><input type="text" id="pName"></div>
                <div class="form-group"><label>á€€á€¯á€á€ºá€”á€¶á€•á€«á€á€º</label><input type="text" id="pCode"></div>
                <div class="form-group"><label>á€á€”á€±á€·á€œá€¯á€•á€ºá€¡á€¬á€¸á€</label><input type="number" id="pWage"></div>
                <div class="form-group"><label>OT á€”á€¬á€›á€®á€</label><input type="number" id="pOt"></div>
                <button class="btn" onclick="saveProfile()">ğŸ’¾ á€á€­á€™á€ºá€¸á€™á€Šá€º</button>
                <a href="https://daily-y-app.github.io/Apk-downlode/" class="btn-link btn-yapp">ğŸ“¥ Y App (Website)</a>
            </div>
        </div>
    </div>

    <div id="successModal" class="modal">
        <div class="modal-content">
            <div style="font-size: 50px; color: #4CAF50;">âœ…</div>
            <h2>á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®</h2>
            <div class="ad-slot-box">
                <script async="async" data-cfasync="false" src="https://pl28343177.effectivegatecpm.com/0c2b6d3f941113823d5379a543284bf7/invoke.js"></script>
                <div id="container-0c2b6d3f941113823d5379a543284bf7"></div>
            </div>
            <button class="done-btn" onclick="closeModal('successModal')">DONE</button>
        </div>
    </div>

    <div id="exitModal" class="modal">
        <div class="modal-content">
            <h2 style="color: #b21f1f;">á€‘á€½á€€á€ºá€™á€¾á€¬ á€á€±á€á€»á€¬á€•á€«á€á€œá€¬á€¸?</h2>
            <div class="ad-slot-box">
                <script async="async" data-cfasync="false" src="https://pl28343177.effectivegatecpm.com/0c2b6d3f941113823d5379a543284bf7/invoke.js"></script>
                <div id="container-0c2b6d3f941113823d5379a543284bf7-exit"></div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="done-btn" style="background: #f44336; flex:1;" onclick="reallyExit()">á€‘á€½á€€á€ºá€™á€Šá€º</button>
                <button class="done-btn" style="background: #888; flex:1;" onclick="closeModal('exitModal')">á€™á€‘á€½á€€á€ºá€•á€«</button>
            </div>
        </div>
    </div>

    <script>
        let records = [];
        try {
            records = JSON.parse(localStorage.getItem('f_recs')) || [];
        } catch(e) { records = []; }
        
        let profile = { name:'User', code:'EMP001', wage:375, ot:69 };
        try {
            let savedProf = JSON.parse(localStorage.getItem('f_prof'));
            if(savedProf) profile = savedProf;
        } catch(e) { }

        let myChart = null;

        function initBackLogic() {
            if (window.history.state?.step !== 1) {
                window.history.pushState({step: 1}, "");
                window.history.pushState({step: 2}, "");
            }
        }
        window.onpopstate = function() {
            document.getElementById('exitModal').style.display = 'flex';
            window.history.pushState({step: 2}, "");
        };
        function reallyExit() {
            window.onpopstate = null;
            window.location.replace("about:blank");
        }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function showPage(id, btn) {
            document.querySelectorAll('.page, .tab').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(btn) btn.classList.add('active');
            if(id === 'balance') updateBalance();
            if(id === 'history') renderList('historyList', records);
            if(id === 'weekly') renderList('weeklyList', records);
            if(id === 'graph') updateGraph(); // á€‚á€›á€•á€ºá€€á€­á€¯ á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€–á€½á€„á€·á€ºá€á€­á€¯á€„á€ºá€¸ Update á€œá€¯á€•á€ºá€™á€Šá€º
        }

        // á€‚á€›á€•á€ºá€›á€±á€¸á€†á€½á€²á€á€Šá€·á€º Function
        function updateGraph() {
            const ctx = document.getElementById('myChart').getContext('2d');
            const income = records.filter(r => r.type === 'income').reduce((a, b) => a + b.amt, 0);
            const expense = records.filter(r => r.type === 'expense').reduce((a, b) => a + b.amt, 0);

            if (myChart) myChart.destroy(); // á€‚á€›á€•á€ºá€¡á€Ÿá€±á€¬á€„á€ºá€¸á€›á€¾á€­á€›á€„á€º á€–á€»á€€á€ºá€•á€¼á€®á€¸ á€¡á€á€…á€ºá€•á€¼á€”á€ºá€†á€½á€²á€™á€Šá€º

            myChart = new Chart(ctx, {
                type: 'doughnut', // Doughnut á€•á€¯á€¶á€…á€¶ á€‚á€›á€•á€º
                data: {
                    labels: ['á€á€„á€ºá€„á€½á€±', 'á€‘á€½á€€á€ºá€„á€½á€±'],
                    datasets: [{
                        data: [income, expense],
                        backgroundColor: ['#4CAF50', '#F44336'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function saveData(type) {
            const date = document.getElementById(type==='income'?'iDate':'eDate').value;
            if(!date) return alert("á€›á€€á€ºá€…á€½á€²á€›á€½á€±á€¸á€•á€«");
            let amt = 0, cat = "";
            if(type === 'income') {
                const h = parseFloat(document.getElementById('iHours').value)||0;
                const ot = parseFloat(document.getElementById('iOt').value)||0;
                const b = parseFloat(document.getElementById('iBonus').value)||0;
                const ex = parseFloat(document.getElementById('iExtra').value)||0;
                amt = (h/8 * profile.wage) + (ot * profile.ot) + b + ex;
                cat = "á€á€„á€ºá€„á€½á€±";
            } else {
                amt = parseFloat(document.getElementById('eAmount').value)||0;
                cat = document.getElementById('eCat').value === 'custom' ? document.getElementById('customCat').value : document.getElementById('eCat').value;
            }
            records.push({ id:Date.now(), type, date, amt, category:cat });
            localStorage.setItem('f_recs', JSON.stringify(records));
            document.getElementById('successModal').style.display = 'flex';
        }

        function updateBalance() {
            const inc = records.filter(r=>r.type==='income').reduce((a,b)=>a+b.amt, 0);
            const exp = records.filter(r=>r.type==='expense').reduce((a,b)=>a+b.amt, 0);
            document.getElementById('totalBal').innerText = (inc - exp).toFixed(0) + 'à¸¿';
            document.getElementById('totalInc').innerText = inc.toFixed(0) + 'à¸¿';
            document.getElementById('totalExp').innerText = exp.toFixed(0) + 'à¸¿';
        }

        function renderList(target, data) {
            const div = document.getElementById(target); div.innerHTML = "";
            data.sort((a,b)=>new Date(b.date)-new Date(a.date)).forEach(r => {
                const isInc = r.type==='income';
                div.innerHTML += `<div class="card" style="display:flex; justify-content:space-between; align-items:center; border-left:5px solid ${isInc?'#4CAF50':'#F44336'}">
                    <div><b>${r.date}</b><br><small>${r.category}</small></div>
                    <div style="text-align:right; color:${isInc?'#4CAF50':'#F44336'}; font-weight:bold;">${isInc?'+':'-'}${r.amt.toFixed(0)}à¸¿
                    <br><button onclick="delRec(${r.id})" style="background:none; border:none; color:#ccc;">ğŸ—‘ï¸</button></div></div>`;
            });
        }

        function delRec(id) {
            if(confirm("á€–á€»á€€á€ºá€™á€¾á€¬á€œá€¬á€¸?")) {
                records = records.filter(r=>r.id!==id);
                localStorage.setItem('f_recs', JSON.stringify(records));
                updateBalance();
                renderList('historyList', records);
            }
        }

        function saveProfile() {
            profile = { 
                name: document.getElementById('pName').value, 
                code: document.getElementById('pCode').value, 
                wage: document.getElementById('pWage').value, 
                ot: document.getElementById('pOt').value 
            };
            localStorage.setItem('f_prof', JSON.stringify(profile));
            document.getElementById('headName').innerText = profile.name;
            document.getElementById('headCode').innerText = "CODE: " + profile.code;
            alert("á€€á€­á€¯á€šá€ºá€›á€±á€¸á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€á€­á€™á€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹");
        }

        function clearAll() {
            if(confirm("á€¡á€€á€¯á€”á€ºá€–á€»á€€á€ºá€™á€¾á€¬á€œá€¬á€¸?")) {
                records = [];
                localStorage.setItem('f_recs', '[]');
                renderList('weeklyList', []);
            }
        }

        window.onload = () => {
            document.getElementById('iDate').valueAsDate = new Date();
            document.getElementById('eDate').valueAsDate = new Date();
            document.getElementById('pName').value = profile.name;
            document.getElementById('pCode').value = profile.code;
            document.getElementById('pWage').value = profile.wage;
            document.getElementById('pOt').value = profile.ot;
            document.getElementById('headName').innerText = profile.name;
            document.getElementById('headCode').innerText = "CODE: " + profile.code;
        };
    </script>
</body>
</html>
